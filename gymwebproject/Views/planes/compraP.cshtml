@model compraPmodel

@{
    ViewBag.Title = "Compra de Suscripción";
    Layout = null;

    string plan = ViewBag.PlanSeleccionado as string;
    decimal precio = (decimal)ViewBag.PrecioSeleccionado;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Comprar Suscripción</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="background: linear-gradient(135deg, #74ebd5, #ACB6E5); min-height: 100vh;">

    <div class="container py-5">
        <div class="row justify-content-center">
            <!-- Columna izquierda (Formulario) -->
            <div class="col-md-7">
                <div class="card shadow-lg p-4 mb-4" style="border-radius: 20px;">
                    <div class="card-body">
                        <h3 class="card-title text-center text-primary mb-4">Formulario de Compra</h3>

                        <form asp-action="compraP" asp-controller="compraP" method="post">
                            <!-- Nombre -->
                            <div class="mb-3">
                                <label asp-for="nombre" class="form-label">Nombre completo</label>
                                <input type="text" asp-for="nombre" class="form-control" readonly />
                            </div>

                            <!-- Correo -->
                            <div class="mb-3">
                                <label asp-for="correo" class="form-label">Correo electrónico</label>
                                <input type="email" asp-for="correo" class="form-control" readonly />
                            </div>

                            <!-- Método de pago -->
                            <div class="mb-3">
                                <label for="pago" class="form-label">Método de pago</label>
                                <select class="form-select" asp-for="metodo" id="pago" required onchange="mostrarCamposPago()">
                                    <option disabled selected value="">Seleccione un método</option>
                                    <option value="Tarjeta">Tarjeta de crédito/débito</option>
                                    <option value="Nequi">Nequi</option>
                                    <option value="Daviplata">Daviplata</option>
                                    <option value="PSE">PSE</option>
                                </select>
                            </div>

                            <!-- Teléfono -->
                            <div id="campoTelefono" class="mb-3 d-none">
                                <label asp-for="numero" class="form-label">Número de teléfono</label>
                                <input type="tel" asp-for="numero" class="form-control" placeholder="Ej: 3001234567">
                            </div>

                            <!-- Tarjeta -->
                            <div id="campoTarjeta" class="mb-3 d-none">
                                <label asp-for="tarjeta" class="form-label">Número de tarjeta</label>
                                <input type="text" asp-for="tarjeta" class="form-control" placeholder="XXXX XXXX XXXX XXXX">
                            </div>

                            <input type="hidden" name="estado" value="Pendiente">
                            <input type="hidden" asp-for="precio" value="@precio" />
                            <input type="hidden" asp-for="suscripcion" value="@plan" />

                            <div class="d-grid">
                                <button type="submit" class="btn btn-success btn-lg">Confirmar Compra</button>
                            </div>
                        </form>

                        <form asp-action="plan2" asp-controller="planes" method="post" class="mt-3">
                            <div class="d-grid">
                                <button type="submit" class="btn btn-danger">Volver</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Columna derecha (Resumen de compra) -->
            <div class="col-md-4">
                <div class="card shadow-lg p-4" style="border-radius: 20px;">
                    <h4 class="text-center text-dark fw-bold">Resumen de compra</h4>
                    <hr>
                    <p><strong>Suscripción:</strong> @plan</p>
                    <p><strong>Precio:</strong> @precio.ToString("C0")</p>
                    <hr>
                    <h5 class="text-success fw-bold text-center">Total: @precio.ToString("C0")</h5>
                </div>
            </div>
        </div>
    </div>

    <script>
        function mostrarCamposPago() {
            const metodo = document.getElementById("pago").value;
            const campoTelefono = document.getElementById("campoTelefono");
            const campoTarjeta = document.getElementById("campoTarjeta");

            campoTelefono.classList.add("d-none");
            campoTarjeta.classList.add("d-none");

            if (metodo === "Nequi" || metodo === "Daviplata") {
                campoTelefono.classList.remove("d-none");
            } else if (metodo === "Tarjeta") {
                campoTarjeta.classList.remove("d-none");
            }
        }
    </script>

</body>
</html>
