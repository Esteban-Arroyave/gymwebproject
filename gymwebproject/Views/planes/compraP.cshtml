@model compraPmodel

@{
    ViewBag.Title = "Compra de Suscripción";
    Layout = null;

    string plan = ViewBag.PlanSeleccionado as string;
    decimal precio = (decimal)ViewBag.PrecioSeleccionado;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Comprar Suscripción</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="background: linear-gradient(135deg, #74ebd5, #ACB6E5); min-height: 100vh;">

    <div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
        <div class="card shadow-lg p-4" style="width: 100%; max-width: 900px; border-radius: 20px;">
            <div class="card-body">
                <h3 class="card-title text-center text-primary mb-4">Formulario de Compra</h3>

                <div class="row">
                    <!-- Columna izquierda: Formulario -->
                    <div class="col-md-7 border-end pe-4">
                        <form asp-action="compraP" asp-controller="compraP" method="post">
                            <!-- Nombre -->
                            <div class="mb-3">
                                <label for="nombre" asp-for="nombre" class="form-label">Nombre completo</label>
                                <input type="text" asp-for="nombre" class="form-control" required>
                            </div>

                            <!-- Correo -->
                            <div class="mb-3">
                                <label for="email" class="form-label">Correo electrónico</label>
                                <input type="email" asp-for="correo" class="form-control" id="email" required>
                            </div>

                            <!-- Método de pago -->
                            <div class="mb-3">
                                <label for="pago" class="form-label">Método de pago</label>
                                <select class="form-select" asp-for="metodo" id="pago" required onchange="mostrarCamposPago()">
                                    <option disabled selected value="">Seleccione un método</option>
                                    <option value="Tarjeta">Tarjeta de crédito/débito</option>
                                    <option value="Nequi">Nequi</option>
                                    <option value="Daviplata">Daviplata</option>
                                    <option value="PSE">PSE</option>
                                </select>
                            </div>

                            <!-- Teléfono (para Nequi/Daviplata) -->
                            <div id="campoTelefono" class="mb-3 d-none">
                                <label for="telefono" class="form-label">Número de teléfono</label>
                                <input type="tel" asp-for="numero" class="form-control" id="telefono" placeholder="Ej: 3001234567">
                            </div>

                            <!-- Tarjeta -->
                            <div id="campoTarjeta" class="mb-3 d-none">
                                <label for="tarjeta" class="form-label">Número de tarjeta</label>
                                <input type="text" asp-for="tarjeta" class="form-control" id="tarjeta" placeholder="XXXX XXXX XXXX XXXX">
                            </div>

                            <div class="mb-3">
                                <input type="hidden" name="estado" value="Pendiente">
                            </div>

                            <div class="d-grid">
                                <button type="submit" class="btn btn-success btn-lg">Confirmar Compra</button>
                            </div>
                        </form>

                        <form asp-action="plan2" asp-controller="planes" method="post" class="mt-3">
                            <div class="d-grid">
                                <button type="submit" class="btn btn-danger">Volver</button>
                            </div>
                        </form>
                    </div>

                    <!-- Columna derecha: Detalles -->
                    <div class="col-md-5 ps-4">
                        <h5 class="text-secondary mb-3">Detalles de la Suscripción</h5>

                        <div class="card border-0 shadow-sm mb-3">
                            <div class="card-body">
                                <p class="fw-bold mb-1">Tipo de suscripción</p>
                                <p class="text-primary fs-5">@plan</p>
                            </div>
                        </div>

                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <p class="fw-bold mb-1">Precio</p>
                                <p class="text-success fs-4">@precio.ToString("C0")</p>
                                <input type="hidden" asp-for="precio" name="Precio" value="@precio" />
                            </div>
                        </div>
                    </div>
                </div><!-- /row -->

            </div>
        </div>
    </div>

    <script>
        function mostrarCamposPago() {
            const metodo = document.getElementById("pago").value;
            const campoTelefono = document.getElementById("campoTelefono");
            const campoTarjeta = document.getElementById("campoTarjeta");

            campoTelefono.classList.add("d-none");
            campoTarjeta.classList.add("d-none");

            if (metodo === "Nequi" || metodo === "Daviplata") {
                campoTelefono.classList.remove("d-none");
            } else if (metodo === "Tarjeta") {
                campoTarjeta.classList.remove("d-none");
            }
        }
    </script>

</body>
</html>
